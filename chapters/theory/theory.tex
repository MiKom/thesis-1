\chapter{Theoretical framework for light simulation}

\section{Useful mathematical concepts}

\begin{df}[Spherical coordinates]
In spherical coordinate system position of a point $P$ in 3D space is described by values: $r$, $\theta$ and $\phi$, where:
\begin{itemize}
\item $r \geq 0$ (\emph{radial distance}) is the Euclidean distance from the origin to $P$.
\item $0 \leq \theta \leq \pi$ (\emph{polar angle}) is the angle between $OP$ line segment and a fixed axis ($OZ$).
\item $0 \leq \phi \leq 2\pi$ (\emph{azimuth angle}) is the angle between other axis ($OX$) and orthogonal projection of $OP$ on the reference plane ($XY$).
\end{itemize}
A point in spherical coordinates $(r, \theta, \phi)$ can be converted into cartesian coordinates $(x, y, z)$ as follows:
\begin{eqnarray}
  x &=& r \sin \theta \cos \phi \nonumber \\
  y &=& r \sin \theta \sin \phi \\
  z &=& r \cos \theta \nonumber
\end{eqnarray}
\end{df}

\begin{df}[Solid angle]
Solid angle subtended by an object visible from point $P$ is the area of that object projected onto a unit sphere around $P$. Solid angles are measured in \emph{steradians} $[sr]$. The entire sphere subtends a solid angle of $4\pi$.
\end{df}

In this work I will, by convention, denote a unit direction vector anchored at some point $P$ in space by $\omega$. Every such vector can be expressed by a point on a unit sphere in spherical coordinates:
\begin{equation}
  \omega(\theta,\phi) := \langle \sin\theta\cos\phi, \sin\theta\sin\phi, \cos\theta \rangle.
\end{equation}
Consider a differntial surface element $dS$ on a unit sphere spanning from $\theta$ to $\theta + d\theta$ and from $\phi$ to $\phi + d\phi$. Differential area of a set of directions $d\omega$ (or, equivalently, solid angle subtended by $dS$) is then
\begin{equation}
  d\omega = \frac{\sin\theta d\theta d\phi}{r^{2}} = \sin\theta d\theta d\phi.
\end{equation}
This relationship is the key to converting integrals over solid angles to integrals over directions.

\begin{df}[Projected solid angle]
Projected solid angle \parencite{nicodemus76} of an object $S$ measured from point $P$ is the solid angle of $S$ projected onto a unit disk perpendicular to the surface normal vector $\vec{N}(P)$ at $P$. Since $\vec{N}(P)$ defines the orientation of the projection plane the projected solid angle is cosine-weighted solid angle of $S$:
\begin{equation}
  \omega^{\perp} = |\cos\theta| \cdot \omega ,
\end{equation}
where $\theta$ is the angle between $\omega$ and surface normal at $P$.
\end{df}

\section{Simulation assumptions}
Simulating light propagation in 3D scenes is very computationaly intensive task. It is generally reasonable to make certain assumptions about the nature of light or the scene itself that can drastically reduce algorithm complexity and speed up simulation without sacrificing noticable image quality. Some physical phenomena are insignificant at macroscopic scale or their effects are too miniscule relative to added simulation complexity.

The following properties are implicitly assumed for the rest of this work:
\begin{itemize}
\item Light transport is considered in the context of \emph{geometric optics} on macroscopic scale (quantumn effects are ignored).
\item Light travels in vaccum with no participating media and is unpolarized.
\item Light consists of radiation of mixed wavelengths and spectral effects, such as dispersion, are ignored.
\item The scene is in the state of energy equilibrium. 
\end{itemize}

\section{Radiometric quantities}
The natural basis for study of light transport in computer graphics is the field of \emph{radiometry} and, by lesser extent, \emph{photometry}.

Radiometry is the study of electromagnetic radiation (which, of course, incldues visible light spectrum) and its interaction with matter. Photometry, on the other hand, studies human perception of light. Defining key radiometric quantities is necessary for proper understanding of light transport theory.

Unless noted otherwise definitions in this section are based on chapter one of \cite{mccluney94}.

\begin{df}
Radiant power $[W=J \cdot s^{-1}]$ (or \emph{radiant flux}) is total amount of energy passing through a surface per unit time.
\begin{equation}
  \Phi := \frac{dQ}{dt}
\end{equation}
\end{df}

\begin{df}
Intensity $[W \cdot sr^{-1}]$ is radiant flux density per unit solid angle.
\begin{equation}
  I := \frac{d\Phi}{d\omega}
\end{equation}
It describes directional distribution of light and is only meaningful for point or small light sources.
\end{df}

\begin{df}
Irradiance $[W \cdot m^{-2}]$ is  area density of radiant flux arriving at a surface around point $x$.
\begin{equation}
  E(x) := \frac{d\Phi(x)}{dA(x)}
\end{equation}
Although formal definition of irradiance includes both sides of the surface in the measurement, for the purpose of computer graphics it is more convenient to consider only the side with normal vector $N(x)$ pointing outwards thus irradiance measures incident radiant flux in the upper hemisphere around point $x$.
\end{df}

\begin{df}
Radiant exitance $[W \cdot m^{-2}]$ \parencite{nicodemus78} is area density of radiant flux leaving a surface around point $x$.
\begin{equation}
  M(x) := \frac{d\Phi(x)}{dA(x)}
\end{equation}
Radiant exitance is analogous to irradiance but measures outgoing radiant flux around point $x$.
\end{df}

\begin{df}
Radiance $[W \cdot m^{-2} \cdot sr^{-1}]$ is radiant flux density per unit area per unit solid angle. It is measured on a differential surface perpendicular to $\omega$ and around point $x$.
\begin{equation}
  L(x,\omega) := \frac{d^{2}\Phi(x, \omega)}{dA(x) |\cos\theta| d\omega},
\end{equation}
where $\theta$ is the angle between $\omega$ and surface normal $\vec{N}(x)$. Radiance can also be formulated by using the dot product of $\omega$ and surface normal:
\begin{equation}
  L(x, \omega) := \frac{d^{2}\Phi(x, \omega)}{|\omega \cdot \vec{N}(x)| dA(x) d\omega}.
\end{equation}
\end{df}

\section{Reflection models}

\subsection{The BRDF}

\subsection{Lambertian reflection}

\subsection{Specular reflection}

\subsection{Fresnel reflectance}

\section{The light transport equation (LTE)}

